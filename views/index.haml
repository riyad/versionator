!!! 5
!!!

%html
  %head
    %title Versionator
    %link{ :href => "stylesheet.css", :rel => "stylesheet", :type => "text/css" }
    %script{ :src => "javascripts/jquery-1.4.4.min.js" }
  %body
    %h1 Versionator
    #root
      - unless @dirs_that_dont_exist.empty?
        .message.error
          %h2 Directories not found
          %ul.vertical.list
            - @dirs_that_dont_exist.each do |dir|
              %li
                = image("folder-exists-not")
                = dir
      .container
      .container.directories
        %h2 Installations
        .container.installations
        - @dirs_that_exist.each do |dir|
          .container.installations
            %h3
              = image("folder")
              = dir
            - @installations[dir].each do |installation|
              %div{ :class => "item #{installation.basic_name}-installation" }
                .logo= logo_for(installation)
                .verdict.unknown
                  &nbsp;
                %h4
                  %span.name= installation.app_name
                  %span.version= installation.installed_version
                %p
                  %a{ :href => installation.project_url }
                    = image("homepage-developer")
                    Project Website
                  - if installation.installed_version_detected?
                    %a{ :href => installation.project_url_for_installed_version }
                      = image("homepage-developer")
                      = installation.app_name
                      = installation.installed_version
                      Release
                .newest-version
                  Newest Version:
                  %span.version
                  = ajax_loader
                  %a.get-version.button
                    = image("version-detect")
                    Load
      #detectors.container
        = toggle_container('#detectors div.detectors')
        %h2
          Application Detectors
        .container.detectors
          %ul.horizontal.detectors.icon.list
            - @detectors.each do |det|
              %li
                %a{ :href => det.project_url }
                  = logo_for(det)
                  = det.app_name
      - @detectors.each do |detector|
        :javascript
          $(document).ready(function() {
            var c = ".#{detector.basic_name}-installation .newest-version";
            $(c).find(".get-version.button").click(function() {
              $(c).find(".version").html("");
              $(c).find(".ajax-loader").show();
              $.get("/apps/#{detector.basic_name}/newest_version", function(data) {
                $(c).find(".ajax-loader").hide();
                $(c).find(".version").html(data);
                $(c).find(".get-version").html("#{escape_javascript(image("version-detect"))} Reload");
              });
            });
          });
